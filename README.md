# UNet Image Segmentation Model

This repository contains an implementation of a UNet model for binary image segmentation using TensorFlow and Keras. The model is applied to a synthetic dataset created from a single image, where a simple thresholding technique is used to generate a binary mask. The UNet model is trained to segment this mask.

## Table of Contents

- [About the Project](#about-the-project)
- [Model Architecture](#model-architecture)
- [Requirements](#requirements)
- [Dataset](#dataset)
- [Usage](#usage)
- [Results](#results)
- [License](#license)

## About the Project

This project demonstrates a basic UNet architecture for image segmentation. The UNet model is a common choice for biomedical image segmentation tasks due to its encoder-decoder structure, allowing it to learn both spatial and contextual information. Here, the model is trained on a single synthetic dataset to predict binary masks from input images.

## Model Architecture

The UNet architecture includes:
1. **Encoder**: Successive convolutional layers followed by max pooling to capture features.
2. **Bottleneck**: The deepest part of the network where feature maps are at their smallest size.
3. **Decoder**: Transposed convolutional layers to upsample the feature maps and combine high-level and low-level features.

## Requirements

- Python 3.x
- TensorFlow 2.x
- NumPy
- PIL (Pillow)
- Matplotlib

You can install the required packages using:
```bash
pip install tensorflow numpy pillow matplotlib
```

## Dataset

This project uses a single image to create a synthetic binary mask, demonstrating the UNet model's segmentation capabilities. The mask is generated by applying a simple threshold to the red channel of the input image. Below are details on how the dataset is structured:

- **Image**: The input image should be 512x512 pixels in RGB format.
- **Synthetic Mask**: A binary mask created by thresholding the red channel of the image.

### Example of Dataset Creation

To create the synthetic mask from an image, use the following code:

```python
from PIL import Image
import numpy as np
```

# Load and preprocess the image
```python
image = Image.open("path_to_your_image.jpg").resize((512, 512)).convert("RGB")
image_array = np.array(image) / 255.0  # Normalize the image to [0, 1] range
```

# Generate a binary mask by thresholding the red channel
```python
threshold_value = 0.5  # Define threshold for mask generation
mask = (image_array[:, :, 0] > threshold_value).astype(np.uint8)  # Binary mask based on red channel
```

# Reshape to a 3-channel or single-channel format as needed
```python
mask = np.expand_dims(mask, axis=-1)  # Single channel for compatibility with the model
```
This code snippet loads an image, normalizes it, and applies a threshold to create a binary mask. The mask can then be used to train and evaluate the UNet model for binary segmentation.

## Usage

1. **Define and Compile the Model**:
    ```python
    model = unet_model(input_shape=(512, 512, 3))
    model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
    ```

2. **Train the Model**:
    Train the model using the synthetic dataset:
    ```python
    history = model.fit(X, Y, epochs=20, batch_size=1)
    ```

3. **Predict**:
    Use the model to generate predictions:
    ```python
    y_pred = model.predict(X)
    ```

4. **Visualize the Results**:
    Visualize the original image, synthetic mask, and the model's predicted mask using Matplotlib:
    ```python
    import matplotlib.pyplot as plt
    
    plt.figure(figsize=(12, 4))
    plt.subplot(1, 3, 1)
    plt.title("Original Image")
    plt.imshow(image_array)

    plt.subplot(1, 3, 2)
    plt.title("Synthetic Mask")
    plt.imshow(mask[:, :, 0], cmap='gray')

    plt.subplot(1, 3, 3)
    plt.title("Predicted Mask")
    plt.imshow(y_pred[0, :, :, 0], cmap='gray')
    
    plt.show()
    ```

## Results

After training, the model's performance can be assessed by comparing the synthetic mask with the model's predicted mask. The visualization shows:
- The **Original Image** used as input.
- The **Synthetic Mask** generated by thresholding the red channel.
- The **Predicted Mask** created by the model, which approximates the synthetic mask.

## License

This project is licensed under the MIT License. See the [LICENSE](LICENSE) file for details.

